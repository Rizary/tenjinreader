module KanjiDB.KanaTable where

import Protolude
import qualified Data.Text as T
import qualified Data.Map as Map
import Data.Char

toHiragana :: Text -> Text
toHiragana t
  | T.null t = t
  | otherwise = case tryPrefix of
    (Just t') -> t'
    (Nothing) -> T.cons (T.head t) (toHiragana $ T.tail t)
  where
    tryPrefix = asum $ map (\n -> f (T.splitAt n t)) [3,2,1]
    -- If prefix is katakana then change it
    -- else return Nothing
    f :: (Text, Text) -> Maybe Text
    f (t1, tr) = case Map.lookup t1 katakanaToHiraganaMap of
      (Just t1') -> Just $ t1' <> (toHiragana tr)
      Nothing -> Nothing


katakanaToHiraganaMap = Map.fromList $
  [ ("ア", "あ")
  , ("ィ", "ぃ")
  , ("イ", "い")
  , ("ゥ", "ぅ")
  , ("ウ", "う")
  , ("ウィ", "うぃ")
  , ("ウェ", "うぇ")
  , ("ェ", "ぇ")
  , ("エ", "え")
  , ("ォ", "ぉ")
  , ("オ", "お")
  , ("カ", "か")
  , ("ガ", "が")
  , ("キ", "き")
  , ("キャ", "きゃ")
  , ("キュ", "きゅ")
  , ("キョ", "きょ")
  , ("ギ", "ぎ")
  , ("ギャ", "ぎゃ")
  , ("ギュ", "ぎゅ")
  , ("ギョ", "ぎょ")
  , ("ク", "く")
  , ("グ", "ぐ")
  , ("ケ", "け")
  , ("ゲ", "げ")
  , ("コ", "こ")
  , ("ゴ", "ご")
  , ("サ", "さ")
  , ("ザ", "ざ")
  , ("シ", "し")
  , ("シャ", "しゃ")
  , ("シュ", "しゅ")
  , ("ショ", "しょ")
  , ("ジ", "じ")
  , ("ジェ", "じぇ")
  , ("ジャ", "じゃ")
  , ("ジュ", "じゅ")
  , ("ジョ", "じょ")
  , ("ス", "す")
  , ("ズ", "ず")
  , ("セ", "せ")
  , ("ゼ", "ぜ")
  , ("ソ", "そ")
  , ("ゾ", "ぞ")
  , ("タ", "た")
  , ("ダ", "だ")
  , ("チ", "ち")
  , ("チェ", "ちぇ")
  , ("チャ", "ちゃ")
  , ("チュ", "ちゅ")
  , ("チョ", "ちょ")
  , ("ヂ", "ぢ")
  , ("ヂャ", "ぢゃ")
  , ("ヂュ", "ぢゅ")
  , ("ヂョ", "ぢょ")
  , ("ッ", "っ")
  , ("ッカ", "っか")
  , ("ッガ", "っが")
  , ("ッキ", "っき")
  , ("ッキャ", "っきゃ")
  , ("ッキュ", "っきゅ")
  , ("ッキョ", "っきょ")
  , ("ッギ", "っぎ")
  , ("ッギャ", "っぎゃ")
  , ("ッギュ", "っぎゅ")
  , ("ッギョ", "っぎょ")
  , ("ック", "っく")
  , ("ッグ", "っぐ")
  , ("ッケ", "っけ")
  , ("ッゲ", "っげ")
  , ("ッコ", "っこ")
  , ("ッゴ", "っご")
  , ("ッサ", "っさ")
  , ("ッザ", "っざ")
  , ("ッシ", "っし")
  , ("ッシャ", "っしゃ")
  , ("ッシュ", "っしゅ")
  , ("ッショ", "っしょ")
  , ("ッジ", "っじ")
  , ("ッジャ", "っじゃ")
  , ("ッジュ", "っじゅ")
  , ("ッジョ", "っじょ")
  , ("ッス", "っす")
  , ("ッズ", "っず")
  , ("ッセ", "っせ")
  , ("ッゼ", "っぜ")
  , ("ッソ", "っそ")
  , ("ッゾ", "っぞ")
  , ("ッタ", "った")
  , ("ッダ", "っだ")
  , ("ッチ", "っち")
  , ("ッチェ", "っちぇ")
  , ("ッチャ", "っちゃ")
  , ("ッチュ", "っちゅ")
  , ("ッチョ", "っちょ")
  , ("ッヂ", "っぢ")
  , ("ッヂャ", "っぢゃ")
  , ("ッヂュ", "っぢゅ")
  , ("ッヂョ", "っぢょ")
  , ("ッツ", "っつ")
  , ("ッテ", "って")
  , ("ッティ", "っち")
  , ("ッデ", "っで")
  , ("ット", "っと")
  , ("ッド", "っど")
  , ("ッドゥ", "っづ")
  , ("ッハ", "っは")
  , ("ッバ", "っば")
  , ("ッパ", "っぱ")
  , ("ッヒ", "っひ")
  , ("ッヒャ", "っひゃ")
  , ("ッヒュ", "っひゅ")
  , ("ッヒョ", "っひょ")
  , ("ッビ", "っび")
  , ("ッビャ", "っびゃ")
  , ("ッビュ", "っびゅ")
  , ("ッビョ", "っびょ")
  , ("ッピ", "っぴ")
  , ("ッピャ", "っぴゃ")
  , ("ッピュ", "っぴゅ")
  , ("ッピョ", "っぴょ")
  , ("ッフ", "っふ")
  , ("ッファ", "っふぁ")
  , ("ッフィ", "っふぃ")
  , ("ッフェ", "っふぇ")
  , ("ッフォ", "っふぉ")
  , ("ッフュ", "っふ")
  , ("ッブ", "っぶ")
  , ("ップ", "っぷ")
  , ("ッヘ", "っへ")
  , ("ッベ", "っべ")
  , ("ッペ", "っぺ")
  , ("ッホ", "っほ")
  , ("ッボ", "っぼ")
  , ("ッポ", "っぽ")
  , ("ッヤ", "っや")
  , ("ッユ", "っゆ")
  , ("ッヨ", "っよ")
  , ("ッラ", "っら")
  , ("ッリ", "っり")
  , ("ッリャ", "っりゃ")
  , ("ッリュ", "っりゅ")
  , ("ッリョ", "っりょ")
  , ("ッル", "っる")
  , ("ッレ", "っれ")
  , ("ッロ", "っろ")
  , ("ッヴ", "っう゛")
  , ("ッヴァ", "っう゛ぁ")
  , ("ッヴィ", "っう゛ぃ")
  , ("ッヴェ", "っう゛ぇ")
  , ("ッヴォ", "っう゛ぉ")
  , ("ツ", "つ")
  , ("ヅ", "づ")
  , ("テ", "て")
  , ("デ", "で")
  , ("ディ", "でぃ")
  , ("ト", "と")
  , ("ド", "ど")
  , ("ナ", "な")
  , ("ニ", "に")
  , ("ニャ", "にゃ")
  , ("ニュ", "にゅ")
  , ("ニョ", "にょ")
  , ("ヌ", "ぬ")
  , ("ネ", "ね")
  , ("ノ", "の")
  , ("ハ", "は")
  , ("バ", "ば")
  , ("パ", "ぱ")
  , ("ヒ", "ひ")
  , ("ヒャ", "ひゃ")
  , ("ヒュ", "ひゅ")
  , ("ヒョ", "ひょ")
  , ("ビ", "び")
  , ("ビャ", "びゃ")
  , ("ビュ", "びゅ")
  , ("ビョ", "びょ")
  , ("ピ", "ぴ")
  , ("ピャ", "ぴゃ")
  , ("ピュ", "ぴゅ")
  , ("ピョ", "ぴょ")
  , ("フ", "ふ")
  , ("ファ", "ふぁ")
  , ("フィ", "ふぃ")
  , ("フェ", "ふぇ")
  , ("フォ", "ふぉ")
  , ("ブ", "ぶ")
  , ("プ", "ぷ")
  , ("ヘ", "へ")
  , ("ベ", "べ")
  , ("ペ", "ぺ")
  , ("ホ", "ほ")
  , ("ボ", "ぼ")
  , ("ポ", "ぽ")
  , ("マ", "ま")
  , ("ミ", "み")
  , ("ミャ", "みゃ")
  , ("ミュ", "みゅ")
  , ("ミョ", "みょ")
  , ("ム", "む")
  , ("メ", "め")
  , ("モ", "も")
  , ("ャ", "ゃ")
  , ("ヤ", "や")
  , ("ュ", "ゅ")
  , ("ユ", "ゆ")
  , ("ョ", "ょ")
  , ("ヨ", "よ")
  , ("ラ", "ら")
  , ("リ", "り")
  , ("リャ", "りゃ")
  , ("リュ", "りゅ")
  , ("リョ", "りょ")
  , ("ル", "る")
  , ("レ", "れ")
  , ("ロ", "ろ")
  , ("ヮ", "ゎ")
  , ("ワ", "わ")
  , ("ヲ", "を")
  , ("ン", "ん")
  , ("ヴ", "う゛")
  , ("ヴァ", "う゛ぁ")
  , ("ヴィ", "う゛ぃ")
  , ("ヴェ", "う゛ぇ")
  , ("ヴォ", "う゛ぉ")]
